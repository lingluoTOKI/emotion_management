# 🧠 情绪管理系统 (Emotion Management System)

<div align="center">

![License](https://img.shields.io/badge/license-MIT-blue.svg)
![Python](https://img.shields.io/badge/python-3.11+-brightgreen.svg)
![Next.js](https://img.shields.io/badge/Next.js-14-black.svg)
![FastAPI](https://img.shields.io/badge/FastAPI-0.104+-green.svg)
![MySQL](https://img.shields.io/badge/MySQL-8.0+-orange.svg)

**基于AI的智能心理健康咨询平台，为学校心理健康服务提供完整的数字化解决方案**

[功能演示](#-功能演示) • [快速开始](#-快速开始) • [技术架构](#️-技术架构) • [API文档](#-api文档) • [贡献指南](#-贡献指南)

</div>

---

## 📋 项目简介

情绪管理系统是一个现代化的心理健康管理平台，集成了AI智能评估、在线咨询、情绪分析等功能。系统支持学生、咨询师和管理员三种用户角色，提供从心理评估到咨询预约的全流程服务。

### 🎯 核心价值
- **智能化**：基于BERT模型的情绪分析和风险评估
- **专业化**：标准化的心理评估量表和咨询流程  
- **便民化**：24/7在线服务，多端访问支持
- **数据化**：完整的数据记录和趋势分析

## ✨ 主要功能

### 🧠 AI智能心理评估
- **情绪识别**：基于EasyBert的实时情绪分析
- **风险评估**：PHQ-9和GAD-7标准量表自动评分
- **危机干预**：自动识别高风险状态并触发预警
- **个性化建议**：根据评估结果提供针对性建议

### 🤖 AI心理助手
- **智能对话**：自然语言处理，理解用户情感需求
- **24/7支持**：全天候在线心理支持服务
- **情绪追踪**：实时监测情绪变化趋势
- **紧急转介**：危机状态自动转接专业咨询师

### 📅 智能咨询预约
- **在线预约**：灵活的时间段选择和咨询师匹配
- **多种方式**：支持面对面、在线视频、电话咨询
- **状态追踪**：实时预约状态和提醒通知
- **历史记录**：完整的咨询记录和效果跟踪

### 📊 数据分析和管理
- **实时统计**：学生心理健康状态整体分析
- **趋势监控**：长期心理健康趋势预测
- **质量评估**：咨询效果和服务质量分析
- **报告生成**：自动生成各类统计报告

## 🏗️ 技术架构

### 后端技术栈
```
FastAPI + Python 3.11+
├── 🗄️ 数据库：MySQL 8.0+ 
├── 🔐 认证：JWT Token + OAuth2
├── 🧠 AI服务：EasyBert + 讯飞星火API
├── 📦 ORM：SQLAlchemy
├── 🚀 部署：Docker + Docker Compose
└── 🧪 测试：Pytest + 54个测试用例
```

### 前端技术栈
```
Next.js 14 + React 18 + TypeScript
├── 🎨 样式：Tailwind CSS
├── ✨ 动画：Framer Motion
├── 📊 图表：Recharts
├── 🎯 图标：Lucide React
├── 🔧 状态：React Hooks + Context
└── 📱 响应式：移动端优先设计
```

### AI核心组件
```
EasyBert 智能分析引擎
├── 🎭 情感分析：Sentiment Analysis
├── 🏷️ 命名实体识别：NER
├── 📝 文本分类：Text Classification  
├── 🔍 文本匹配：Text Matching
└── ⚡ 模型优化：FGM + EMA + PGD
```

## 🚀 快速开始

### 环境要求
- Python 3.11+
- Node.js 18+
- MySQL 8.0+
- Docker (可选)

### 1. 克隆项目
```bash
git clone https://github.com/lingluoTOKI/emotion_management.git
cd emotion_management
```

### 2. 数据库设置
```bash
# 进入数据库目录
cd database

# 配置数据库连接（复制并编辑配置文件）
cp config.env.template config.env

# 初始化数据库
python init_db.py

# 或使用快速部署脚本
./quick_deploy.bat
```

### 3. 后端启动
```bash
cd backend

# 创建虚拟环境
python -m venv venv
source venv/bin/activate  # Linux/Mac
# 或 venv\Scripts\activate  # Windows

# 安装依赖
pip install -r requirements.txt

# 启动服务
python main.py
```

### 4. 前端启动
```bash
cd frontend

# 安装依赖
npm install

# 启动开发服务器
npm run dev
```

### 5. 访问系统
- 前端地址：http://localhost:3000
- 后端API：http://localhost:8000
- API文档：http://localhost:8000/docs

### 🐳 Docker快速部署
```bash
# 使用Docker Compose一键启动
docker-compose up -d

# 查看服务状态
docker-compose ps
```

## 🗂️ 项目结构

```
emotion_management/
├── 📂 backend/           # 后端服务
│   ├── app/             # 应用核心代码
│   │   ├── api/         # API路由
│   │   ├── core/        # 核心配置
│   │   ├── models/      # 数据模型
│   │   ├── schemas/     # 数据验证
│   │   └── services/    # 业务逻辑
│   ├── EasyBert/        # AI模型组件
│   ├── tests/           # 测试文件
│   │   ├── api/         # API测试
│   │   ├── integration/ # 集成测试
│   │   ├── database/    # 数据库测试
│   │   └── debug/       # 调试工具
│   └── requirements.txt # Python依赖
├── 📂 frontend/          # 前端应用
│   ├── src/app/         # Next.js应用
│   ├── components/      # 公共组件
│   └── package.json     # Node.js依赖
├── 📂 database/          # 数据库脚本
├── 📂 docs/             # 项目文档
├── 📂 scripts/          # 部署脚本
└── 🐳 docker-compose.yml # Docker配置
```

## 📊 功能演示

### 学生端界面
- 🏠 **个人仪表板**：心理健康状态概览
- 🧠 **AI智能评估**：交互式心理状态评估
- 💬 **AI聊天助手**：24小时在线心理支持
- 📅 **咨询预约**：在线预约心理咨询师
- 📋 **评估历史**：查看历史评估记录和趋势

### 咨询师端界面  
- 📊 **工作台**：学生咨询请求和状态监控
- 👥 **学生管理**：查看和管理负责的学生
- 📈 **数据分析**：学生心理状态趋势分析
- 💼 **咨询记录**：详细的咨询记录和跟进计划

### 管理员界面
- 🎛️ **系统概览**：整体运营数据监控
- 👨‍⚕️ **咨询师管理**：咨询师信息和排班管理
- 📊 **数据报告**：生成各类统计分析报告
- ⚙️ **系统设置**：平台配置和权限管理

## 🧪 测试覆盖

项目包含完整的测试套件，确保代码质量和功能稳定性：

```
tests/
├── 📁 api/ (12个测试)        # API接口测试
├── 📁 integration/ (26个测试) # 集成测试
├── 📁 database/ (2个测试)    # 数据库测试
├── 📁 debug/ (13个测试)      # 调试工具
└── 📁 utils/ (1个测试)       # 工具函数测试
```

运行测试：
```bash
# 运行所有测试
python -m pytest tests/

# 运行特定模块测试
python tests/api/test_login_api.py
python tests/integration/test_ai_integration.py
```

## 🔧 配置说明

### 环境变量配置
创建 `.env` 文件：
```env
# 数据库配置
DATABASE_URL=mysql://username:password@localhost:3306/emotion_db

# JWT配置
SECRET_KEY=your-secret-key
ACCESS_TOKEN_EXPIRE_MINUTES=1440

# AI服务配置
XFYUN_APP_ID=your-app-id
XFYUN_API_SECRET=your-api-secret
XFYUN_API_KEY=your-api-key

# 其他配置
DEBUG=True
CORS_ORIGINS=["http://localhost:3000"]
```

### 数据库配置
在 `database/config.env` 中配置：
```env
MYSQL_HOST=localhost
MYSQL_PORT=3306
MYSQL_USER=root
MYSQL_PASSWORD=your-password
MYSQL_DATABASE=emotion_db
```

## 📚 API文档

系统提供完整的API文档，启动后端服务后访问：

- **Swagger UI**: http://localhost:8000/docs
- **ReDoc**: http://localhost:8000/redoc

### 主要API端点

| 模块 | 端点 | 描述 |
|------|------|------|
| 认证 | `/api/auth/login` | 用户登录 |
| 学生 | `/api/student/assessment` | 心理评估 |
| AI | `/api/ai/chat` | AI对话 |
| 咨询 | `/api/consultation/book` | 预约咨询 |
| 管理 | `/api/admin/users` | 用户管理 |

## 🎯 核心特性

### 🔒 安全性
- JWT Token认证机制
- 密码加密存储
- SQL注入防护
- XSS攻击防护
- CORS跨域配置

### 🚀 性能优化
- 数据库查询优化
- 前端代码分割
- 图片懒加载
- API响应缓存
- CDN静态资源

### 📱 响应式设计
- 移动端适配
- 多设备兼容
- 触摸手势支持
- 离线状态提示

## 🛠️ 开发指南

### 代码规范
- Python: PEP 8
- TypeScript: ESLint + Prettier
- Git: Conventional Commits

### 开发工具
- 后端: PyCharm / VS Code
- 前端: VS Code
- 数据库: MySQL Workbench
- API测试: Postman

### 提交规范
```bash
feat: 新功能
fix: 修复bug
docs: 文档更新
style: 代码格式调整
refactor: 代码重构
test: 测试相关
chore: 构建过程或辅助工具的变动
```

## 🤝 贡献指南

我们欢迎所有形式的贡献！请查看 [贡献指南](CONTRIBUTING.md) 了解详细信息。

### 贡献流程
1. Fork 本项目
2. 创建特性分支 (`git checkout -b feature/amazing-feature`)
3. 提交更改 (`git commit -m 'feat: add amazing feature'`)
4. 推送到分支 (`git push origin feature/amazing-feature`)
5. 创建 Pull Request

### 问题反馈
如果您发现bug或有功能建议，请通过以下方式反馈：
- 📧 Email: lingluotoki@example.com
- 🐛 Issues: [GitHub Issues](https://github.com/lingluoTOKI/emotion_management/issues)

## 📄 许可证

本项目基于 MIT 许可证开源。详细信息请查看 [LICENSE](LICENSE) 文件。

## 🙏 致谢

感谢以下开源项目和贡献者：

- **EasyBert**: AI模型核心组件
- **FastAPI**: 高性能Web框架
- **Next.js**: 现代化前端框架
- **Tailwind CSS**: 实用优先的CSS框架
- **讯飞星火**: AI对话服务支持

## 📞 联系我们

- **项目维护者**: [lingluoTOKI](https://github.com/lingluoTOKI)
- **GitHub**: https://github.com/lingluoTOKI/emotion_management
- **文档**: [在线文档](https://github.com/lingluoTOKI/emotion_management/wiki)

---

<div align="center">

**如果这个项目对您有帮助，请给我们一个 ⭐️ Star!**

Made with ❤️ by [lingluoTOKI](https://github.com/lingluoTOKI)

</div>